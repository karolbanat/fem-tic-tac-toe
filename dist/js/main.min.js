"use strict";function _createForOfIteratorHelper(e,t){var r,n,i,a,o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(o)return n=!(r=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return r=e.done,e},e:function(e){n=!0,i=e},f:function(){try{r||null==o.return||o.return()}finally{if(n)throw i}}};if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Game=_createClass(function e(t,r){var i=this;_classCallCheck(this,e),this.ties=0,this.init=function(e,t){var r="x"===t?"o":"x",n="singleplayer"===e?"you":"p1",e="singleplayer"===e?"cpu":"p2";"x"===t?(i.xPlayer=new Player(n,t),i.oPlayer=new Player(e,r)):(i.xPlayer=new Player(e,r),i.oPlayer=new Player(n,t)),i.currentPlayer=i.xPlayer,i.gameContainer.classList.remove("hidden"),i.scoreBoard.init(i.xPlayer,i.oPlayer,i.ties),i.gameBoard.init()},this.onFieldClick=function(e){i.makeMove()},this.getCurrentPlayerMark=function(){return i.currentPlayer.getMark()},this.makeMove=function(){},this.gameMenu=new GameMenu(t,this.init),this.gameMenu.init(),this.gameContainer=document.querySelector(r),this.scoreBoard=new ScoreBoard("#score-board"),this.gameBoard=new GameBoard("#game-board",this.onFieldClick,this.getCurrentPlayerMark)}),GameMenu=_createClass(function e(t,r){var n=this;_classCallCheck(this,e),this.gameInit=r,this.init=function(){n.formSubmitButtons.forEach(function(e){return e.addEventListener("click",n.handleMenuSubmitButton)})},this.handleMenuSubmitButton=function(e){var t;e.preventDefault(),n.isAnyOptionSelected()?(n.errorMsg.classList.remove("visible"),n.errorMsg.innerText="",e=e.target.dataset.mode,t=n.getCheckedOptionMark(),n.gameMenu.classList.add("hidden"),n.gameInit(e,t)):(n.errorMsg.classList.add("visible"),n.errorMsg.innerText="Please select mark for player 1")},this.isAnyOptionSelected=function(){return Array.from(n.formOptions).some(function(e){return e.checked})},this.getCheckedOptionMark=function(){var e,t=_createForOfIteratorHelper(n.formOptions);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(r.checked)return r.dataset.mark}}catch(e){t.e(e)}finally{t.f()}return""},this.gameMenu=document.querySelector(t),this.menuForm=this.gameMenu.querySelector("form"),this.formOptions=this.menuForm.querySelectorAll('input[type="radio"]'),this.errorMsg=this.menuForm.querySelector('[role="alert"]'),this.formSubmitButtons=this.menuForm.querySelectorAll('button[type="submit"]')}),ScoreBoard=_createClass(function e(t){var n=this;_classCallCheck(this,e),this.init=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;n.p1Label.innerText=e.toString(),n.p2Label.innerText=t.toString(),n.updateScore(e,t,r)},this.updateScore=function(e,t,r){n.p1Score.innerText=e.getScore().toString(),n.p2Score.innerText=t.getScore().toString(),n.tiesScore.innerText=r.toString()},this.scoreBoardContainer=document.querySelector(t),this.p1Label=this.scoreBoardContainer.querySelector("#p1-game-name"),this.p1Score=this.scoreBoardContainer.querySelector("#p1-game-score"),this.p2Label=this.scoreBoardContainer.querySelector("#p2-game-name"),this.p2Score=this.scoreBoardContainer.querySelector("#p2-game-score"),this.tiesScore=this.scoreBoardContainer.querySelector("#game-ties")}),GameBoard=_createClass(function e(t,r,n){var i=this;_classCallCheck(this,e),this.onFieldClick=r,this.getCurrentMark=n,this.BOARD_SIZE=3,this.board=[[],[],[]],this.init=function(){for(var e=i.boardElement.querySelectorAll(".game-board__field"),t=0;t<i.board.length;t++)for(var r=0;r<i.BOARD_SIZE;r++)i.board[t].push(new Field(t,r,e[r+t*i.BOARD_SIZE],i.onFieldClick,i.getCurrentMark))},this.checkField=function(e,t,r){t<i.board.length&&r<i.board[0].length&&i.board[t][r].check(e)},this.boardElement=document.querySelector(t)}),Field=_createClass(function e(t,r,n,i,a){var o=this;_classCallCheck(this,e),this.row=t,this.column=r,this.fieldElement=n,this.gameOnClickHandler=i,this.getCurrentMark=a,this.mark=null,this.handleHover=function(){var e=o.getCurrentMark();o.fieldElement.setAttribute("data-current-player",e)},this.handleBlur=function(){o.fieldElement.removeAttribute("data-current-player")},this.insertImages=function(){var e=document.createElement("img"),t=(e.setAttribute("src","./dist/assets/icon-o.svg"),e.setAttribute("alt",""),e.setAttribute("data-name","o-icon"),document.createElement("img")),r=(t.setAttribute("src","./dist/assets/icon-o-outline.svg"),t.setAttribute("alt",""),e.setAttribute("data-name","o-outline-icon"),document.createElement("img")),n=(r.setAttribute("src","./dist/assets/icon-x.svg"),r.setAttribute("alt",""),r.setAttribute("data-name","x-icon"),document.createElement("img"));n.setAttribute("src","./dist/assets/icon-x-outline.svg"),n.setAttribute("alt",""),n.setAttribute("data-name","x-outline-icon"),o.fieldElement.appendChild(e),o.fieldElement.appendChild(r),o.fieldElement.appendChild(t),o.fieldElement.appendChild(n)},this.check=function(e){o.mark=e,o.fieldElement.setAttribute("aria-label","Row ".concat(o.row+1,", column ").concat(o.column+1,", ").concat(o.mark," mark"))},this.isChecked=function(){return null!==o.mark},this.getMark=function(){return o.mark},this.fieldElement&&(this.fieldElement.addEventListener("click",this.gameOnClickHandler),this.fieldElement.addEventListener("mouseover",this.handleHover),this.fieldElement.addEventListener("focusin",this.handleHover),this.fieldElement.addEventListener("mouseout",this.handleBlur),this.fieldElement.addEventListener("focusout",this.handleBlur),this.fieldElement.dataset.row=this.row.toString(),this.fieldElement.dataset.column=this.column.toString(),this.fieldElement.setAttribute("aria-label","Row ".concat(this.row+1,", column ").concat(this.column+1,", empty field")),this.insertImages())}),Player=_createClass(function e(t,r){var n=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,e),this.name=t,this.mark=r,this.score=i,this.toString=function(){return"".concat(n.mark," (").concat(n.name,")")},this.getMark=function(){return n.mark},this.getScore=function(){return n.score},this.updateScore=function(){return++n.score}}),ticTacToeGame=new Game("#game-menu","#tic-tac-toe-game");
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOlsiR2FtZSIsIl9jcmVhdGVDbGFzcyIsImdhbWVNZW51SWQiLCJnYW1lQ29udGFpbmVySWQiLCJfdGhpcyIsInRoaXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aWVzIiwiaW5pdCIsIm1vZGUiLCJwMU1hcmsiLCJwMk1hcmsiLCJwMUxhYmVsIiwicDJMYWJlbCIsInhQbGF5ZXIiLCJQbGF5ZXIiLCJvUGxheWVyIiwiY3VycmVudFBsYXllciIsImdhbWVDb250YWluZXIiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzY29yZUJvYXJkIiwiZ2FtZUJvYXJkIiwib25GaWVsZENsaWNrIiwiZXYiLCJtYWtlTW92ZSIsImdldEN1cnJlbnRQbGF5ZXJNYXJrIiwiZ2V0TWFyayIsImdhbWVNZW51IiwiR2FtZU1lbnUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJTY29yZUJvYXJkIiwiR2FtZUJvYXJkIiwiZ2FtZUluaXQiLCJfdGhpczIiLCJmb3JtU3VibWl0QnV0dG9ucyIsImZvckVhY2giLCJidG4iLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlTWVudVN1Ym1pdEJ1dHRvbiIsInByZXZlbnREZWZhdWx0IiwiaXNBbnlPcHRpb25TZWxlY3RlZCIsImVycm9yTXNnIiwiaW5uZXJUZXh0IiwiZ2FtZU1vZGUiLCJ0YXJnZXQiLCJkYXRhc2V0IiwiZ2V0Q2hlY2tlZE9wdGlvbk1hcmsiLCJhZGQiLCJBcnJheSIsImZyb20iLCJmb3JtT3B0aW9ucyIsInNvbWUiLCJvcHRpb24iLCJjaGVja2VkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsInMiLCJuIiwiZG9uZSIsInZhbHVlIiwibWFyayIsImVyciIsImUiLCJmIiwibWVudUZvcm0iLCJxdWVyeVNlbGVjdG9yQWxsIiwic2NvcmVCb2FyZElkIiwiX3RoaXMzIiwicDEiLCJwMiIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInRvU3RyaW5nIiwidXBkYXRlU2NvcmUiLCJwMVNjb3JlIiwiZ2V0U2NvcmUiLCJwMlNjb3JlIiwidGllc1Njb3JlIiwic2NvcmVCb2FyZENvbnRhaW5lciIsImdhbWVCb2FyZElkIiwiZ2V0Q3VycmVudE1hcmsiLCJfdGhpczQiLCJCT0FSRF9TSVpFIiwiYm9hcmQiLCJib2FyZEZpZWxkRWxlbWVudHMiLCJib2FyZEVsZW1lbnQiLCJyb3ciLCJjb2x1bW4iLCJwdXNoIiwiRmllbGQiLCJjaGVja0ZpZWxkIiwiY2hlY2siLCJmaWVsZEVsZW1lbnQiLCJnYW1lT25DbGlja0hhbmRsZXIiLCJfdGhpczUiLCJoYW5kbGVIb3ZlciIsImN1cnJlbnRQbGF5ZXJNYXJrIiwic2V0QXR0cmlidXRlIiwiaGFuZGxlQmx1ciIsInJlbW92ZUF0dHJpYnV0ZSIsImluc2VydEltYWdlcyIsIm9JbWFnZSIsImNyZWF0ZUVsZW1lbnQiLCJvT3V0bGluZUltYWdlIiwieEltYWdlIiwieE91dGxpbmVJbWFnZSIsImFwcGVuZENoaWxkIiwiY29uY2F0IiwiaXNDaGVja2VkIiwibmFtZSIsIl90aGlzNiIsInNjb3JlIiwidGljVGFjVG9lR2FtZSJdLCJtYXBwaW5ncyI6IjZqREFDQSxJQUNNQSxLQUFJQyxhQVVULFNBQUFELEVBQVlFLEVBQW9CQyxHQUF1QixJQUFBQyxFQUFBQyxLQUFBQyxnQkFBQUQsS0FBQUwsQ0FBQSxFQUYvQ0ssS0FBQUUsS0FBZSxFQVV2QkYsS0FBQUcsS0FBTyxTQUFDQyxFQUFjQyxHQUNyQixJQUFNQyxFQUE0QixNQUFYRCxFQUFpQixJQUFNLElBQ3hDRSxFQUEyQixpQkFBVEgsRUFBMEIsTUFBUSxLQUNwREksRUFBMkIsaUJBQVRKLEVBQTBCLE1BQVEsS0FFM0MsTUFBWEMsR0FDSE4sRUFBS1UsUUFBVSxJQUFJQyxPQUFPSCxFQUFTRixDQUFNLEVBQ3pDTixFQUFLWSxRQUFVLElBQUlELE9BQU9GLEVBQVNGLENBQU0sSUFFekNQLEVBQUtVLFFBQVUsSUFBSUMsT0FBT0YsRUFBU0YsQ0FBTSxFQUN6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QUssQ0FSNEMsQ0FBQyxFQWNoRkMsY0FBc0IsSUFBSXBILEtBQUssYUFBYyxtQkFBbUIiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBjbGFzc2VzICovXHJcbi8qIEdhbWUgY2xhc3Mgc3RhcnQgKi9cclxuY2xhc3MgR2FtZSB7XHJcblx0cHJpdmF0ZSBnYW1lTWVudTogR2FtZU1lbnU7XHJcblx0cHJpdmF0ZSBnYW1lQ29udGFpbmVyOiBIVE1MRWxlbWVudDtcclxuXHRwcml2YXRlIGdhbWVCb2FyZDogR2FtZUJvYXJkO1xyXG5cdHByaXZhdGUgc2NvcmVCb2FyZDogU2NvcmVCb2FyZDtcclxuXHRwcml2YXRlIHhQbGF5ZXI6IFBsYXllcjtcclxuXHRwcml2YXRlIG9QbGF5ZXI6IFBsYXllcjtcclxuXHRwcml2YXRlIGN1cnJlbnRQbGF5ZXI6IFBsYXllcjtcclxuXHRwcml2YXRlIHRpZXM6IG51bWJlciA9IDA7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGdhbWVNZW51SWQ6IHN0cmluZywgZ2FtZUNvbnRhaW5lcklkOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMuZ2FtZU1lbnUgPSBuZXcgR2FtZU1lbnUoZ2FtZU1lbnVJZCwgdGhpcy5pbml0KTtcclxuXHRcdHRoaXMuZ2FtZU1lbnUuaW5pdCgpO1xyXG5cdFx0dGhpcy5nYW1lQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihnYW1lQ29udGFpbmVySWQpO1xyXG5cdFx0dGhpcy5zY29yZUJvYXJkID0gbmV3IFNjb3JlQm9hcmQoJyNzY29yZS1ib2FyZCcpO1xyXG5cdFx0dGhpcy5nYW1lQm9hcmQgPSBuZXcgR2FtZUJvYXJkKCcjZ2FtZS1ib2FyZCcsIHRoaXMub25GaWVsZENsaWNrLCB0aGlzLmdldEN1cnJlbnRQbGF5ZXJNYXJrKTtcclxuXHR9XHJcblxyXG5cdGluaXQgPSAobW9kZTogc3RyaW5nLCBwMU1hcms6IHN0cmluZyk6IHZvaWQgPT4ge1xyXG5cdFx0Y29uc3QgcDJNYXJrOiBzdHJpbmcgPSBwMU1hcmsgPT09ICd4JyA/ICdvJyA6ICd4JztcclxuXHRcdGNvbnN0IHAxTGFiZWw6IHN0cmluZyA9IG1vZGUgPT09ICdzaW5nbGVwbGF5ZXInID8gJ3lvdScgOiAncDEnO1xyXG5cdFx0Y29uc3QgcDJMYWJlbDogc3RyaW5nID0gbW9kZSA9PT0gJ3NpbmdsZXBsYXllcicgPyAnY3B1JyA6ICdwMic7XHJcblxyXG5cdFx0aWYgKHAxTWFyayA9PT0gJ3gnKSB7XHJcblx0XHRcdHRoaXMueFBsYXllciA9IG5ldyBQbGF5ZXIocDFMYWJlbCwgcDFNYXJrKTtcclxuXHRcdFx0dGhpcy5vUGxheWVyID0gbmV3IFBsYXllcihwMkxhYmVsLCBwMk1hcmspO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy54UGxheWVyID0gbmV3IFBsYXllcihwMkxhYmVsLCBwMk1hcmspO1xyXG5cdFx0XHR0aGlzLm9QbGF5ZXIgPSBuZXcgUGxheWVyKHAxTGFiZWwsIHAxTWFyayk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5jdXJyZW50UGxheWVyID0gdGhpcy54UGxheWVyO1xyXG5cdFx0dGhpcy5nYW1lQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xyXG5cdFx0dGhpcy5zY29yZUJvYXJkLmluaXQodGhpcy54UGxheWVyLCB0aGlzLm9QbGF5ZXIsIHRoaXMudGllcyk7XHJcblx0XHR0aGlzLmdhbWVCb2FyZC5pbml0KCk7XHJcblx0fTtcclxuXHJcblx0b25GaWVsZENsaWNrID0gKGV2OiBFdmVudCk6IHZvaWQgPT4ge1xyXG5cdFx0dGhpcy5tYWtlTW92ZSgpO1xyXG5cdH07XHJcblxyXG5cdGdldEN1cnJlbnRQbGF5ZXJNYXJrID0gKCk6IHN0cmluZyA9PiB7XHJcblx0XHRyZXR1cm4gdGhpcy5jdXJyZW50UGxheWVyLmdldE1hcmsoKTtcclxuXHR9O1xyXG5cclxuXHRtYWtlTW92ZSA9ICgpID0+IHt9O1xyXG59XHJcbi8qIEdhbWUgY2xhc3MgZW5kICovXHJcblxyXG4vKiBHYW1lTWVudSBjbGFzcyBzdGFydCAqL1xyXG5jbGFzcyBHYW1lTWVudSB7XHJcblx0cHJpdmF0ZSBnYW1lTWVudTogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBtZW51Rm9ybTogSFRNTEZvcm1FbGVtZW50O1xyXG5cdHByaXZhdGUgZm9ybU9wdGlvbnM6IE5vZGVMaXN0T2Y8SFRNTElucHV0RWxlbWVudD47XHJcblx0cHJpdmF0ZSBlcnJvck1zZzogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBmb3JtU3VibWl0QnV0dG9uczogTm9kZUxpc3RPZjxIVE1MQnV0dG9uRWxlbWVudD47XHJcblxyXG5cdGNvbnN0cnVjdG9yKGdhbWVNZW51SWQ6IHN0cmluZywgcHJpdmF0ZSBnYW1lSW5pdDogKG1vZGU6IHN0cmluZywgcDFNYXJrOiBzdHJpbmcpID0+IHZvaWQpIHtcclxuXHRcdHRoaXMuZ2FtZU1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGdhbWVNZW51SWQpO1xyXG5cdFx0dGhpcy5tZW51Rm9ybSA9IHRoaXMuZ2FtZU1lbnUucXVlcnlTZWxlY3RvcignZm9ybScpO1xyXG5cdFx0dGhpcy5mb3JtT3B0aW9ucyA9IHRoaXMubWVudUZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1cInJhZGlvXCJdJyk7XHJcblx0XHR0aGlzLmVycm9yTXNnID0gdGhpcy5tZW51Rm9ybS5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cImFsZXJ0XCJdJyk7XHJcblx0XHR0aGlzLmZvcm1TdWJtaXRCdXR0b25zID0gdGhpcy5tZW51Rm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xyXG5cdH1cclxuXHJcblx0aW5pdCA9ICgpOiB2b2lkID0+IHtcclxuXHRcdHRoaXMuZm9ybVN1Ym1pdEJ1dHRvbnMuZm9yRWFjaChidG4gPT4gYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVNZW51U3VibWl0QnV0dG9uKSk7XHJcblx0fTtcclxuXHJcblx0aGFuZGxlTWVudVN1Ym1pdEJ1dHRvbiA9IChldjogRXZlbnQpOiB2b2lkID0+IHtcclxuXHRcdGV2LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRpZiAoIXRoaXMuaXNBbnlPcHRpb25TZWxlY3RlZCgpKSB7XHJcblx0XHRcdHRoaXMuZXJyb3JNc2cuY2xhc3NMaXN0LmFkZCgndmlzaWJsZScpO1xyXG5cdFx0XHR0aGlzLmVycm9yTXNnLmlubmVyVGV4dCA9ICdQbGVhc2Ugc2VsZWN0IG1hcmsgZm9yIHBsYXllciAxJztcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5lcnJvck1zZy5jbGFzc0xpc3QucmVtb3ZlKCd2aXNpYmxlJyk7XHJcblx0XHRcdHRoaXMuZXJyb3JNc2cuaW5uZXJUZXh0ID0gJyc7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3Qgc3VibWl0QnRuOiBIVE1MQnV0dG9uRWxlbWVudCA9IGV2LnRhcmdldCBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuXHRcdGNvbnN0IGdhbWVNb2RlOiBzdHJpbmcgPSBzdWJtaXRCdG4uZGF0YXNldC5tb2RlO1xyXG5cdFx0Y29uc3QgcDFNYXJrOiBzdHJpbmcgPSB0aGlzLmdldENoZWNrZWRPcHRpb25NYXJrKCk7XHJcblx0XHR0aGlzLmdhbWVNZW51LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xyXG5cdFx0dGhpcy5nYW1lSW5pdChnYW1lTW9kZSwgcDFNYXJrKTsgLy8gbWV0aG9kIGZyb20gdGhlIHBhcmVudCBHYW1lIGNsYXNzXHJcblx0fTtcclxuXHJcblx0aXNBbnlPcHRpb25TZWxlY3RlZCA9ICgpOiBib29sZWFuID0+IHtcclxuXHRcdHJldHVybiBBcnJheS5mcm9tKHRoaXMuZm9ybU9wdGlvbnMpLnNvbWUob3B0aW9uID0+IG9wdGlvbi5jaGVja2VkKTtcclxuXHR9O1xyXG5cclxuXHRnZXRDaGVja2VkT3B0aW9uTWFyayA9ICgpOiBzdHJpbmcgPT4ge1xyXG5cdFx0Zm9yIChjb25zdCBvcHRpb24gb2YgdGhpcy5mb3JtT3B0aW9ucykge1xyXG5cdFx0XHRpZiAob3B0aW9uLmNoZWNrZWQpIHJldHVybiBvcHRpb24uZGF0YXNldC5tYXJrO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICcnO1xyXG5cdH07XHJcbn1cclxuLyogR2FtZU1lbnUgY2xhc3MgZW5kICovXHJcblxyXG4vKiBTY29yZUJvYXJkIGNsYXNzIHN0YXJ0ICovXHJcbmNsYXNzIFNjb3JlQm9hcmQge1xyXG5cdHByaXZhdGUgc2NvcmVCb2FyZENvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBwMUxhYmVsOiBIVE1MRWxlbWVudDtcclxuXHRwcml2YXRlIHAxU2NvcmU6IEhUTUxFbGVtZW50O1xyXG5cdHByaXZhdGUgcDJMYWJlbDogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBwMlNjb3JlOiBIVE1MRWxlbWVudDtcclxuXHRwcml2YXRlIHRpZXNTY29yZTogSFRNTEVsZW1lbnQ7XHJcblxyXG5cdGNvbnN0cnVjdG9yKHNjb3JlQm9hcmRJZDogc3RyaW5nKSB7XHJcblx0XHR0aGlzLnNjb3JlQm9hcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNjb3JlQm9hcmRJZCk7XHJcblx0XHR0aGlzLnAxTGFiZWwgPSB0aGlzLnNjb3JlQm9hcmRDb250YWluZXIucXVlcnlTZWxlY3RvcignI3AxLWdhbWUtbmFtZScpO1xyXG5cdFx0dGhpcy5wMVNjb3JlID0gdGhpcy5zY29yZUJvYXJkQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNwMS1nYW1lLXNjb3JlJyk7XHJcblx0XHR0aGlzLnAyTGFiZWwgPSB0aGlzLnNjb3JlQm9hcmRDb250YWluZXIucXVlcnlTZWxlY3RvcignI3AyLWdhbWUtbmFtZScpO1xyXG5cdFx0dGhpcy5wMlNjb3JlID0gdGhpcy5zY29yZUJvYXJkQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJyNwMi1nYW1lLXNjb3JlJyk7XHJcblx0XHR0aGlzLnRpZXNTY29yZSA9IHRoaXMuc2NvcmVCb2FyZENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcjZ2FtZS10aWVzJyk7XHJcblx0fVxyXG5cclxuXHRpbml0ID0gKHAxOiBQbGF5ZXIsIHAyOiBQbGF5ZXIsIHRpZXM6IG51bWJlciA9IDApOiB2b2lkID0+IHtcclxuXHRcdHRoaXMucDFMYWJlbC5pbm5lclRleHQgPSBwMS50b1N0cmluZygpO1xyXG5cdFx0dGhpcy5wMkxhYmVsLmlubmVyVGV4dCA9IHAyLnRvU3RyaW5nKCk7XHJcblx0XHR0aGlzLnVwZGF0ZVNjb3JlKHAxLCBwMiwgdGllcyk7XHJcblx0fTtcclxuXHJcblx0dXBkYXRlU2NvcmUgPSAocDE6IFBsYXllciwgcDI6IFBsYXllciwgdGllczogbnVtYmVyKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLnAxU2NvcmUuaW5uZXJUZXh0ID0gcDEuZ2V0U2NvcmUoKS50b1N0cmluZygpO1xyXG5cdFx0dGhpcy5wMlNjb3JlLmlubmVyVGV4dCA9IHAyLmdldFNjb3JlKCkudG9TdHJpbmcoKTtcclxuXHRcdHRoaXMudGllc1Njb3JlLmlubmVyVGV4dCA9IHRpZXMudG9TdHJpbmcoKTtcclxuXHR9O1xyXG59XHJcbi8qIFNjb3JlQm9hcmQgY2xhc3MgZW5kICovXHJcblxyXG4vKiBHYW1lQm9hcmQgY2xhc3Mgc3RhcnQgKi9cclxuY2xhc3MgR2FtZUJvYXJkIHtcclxuXHRwcml2YXRlIEJPQVJEX1NJWkU6IG51bWJlciA9IDM7XHJcblx0cHJpdmF0ZSBib2FyZEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG5cdHByaXZhdGUgYm9hcmQ6IEZpZWxkW11bXSA9IFtbXSwgW10sIFtdXTtcclxuXHJcblx0Y29uc3RydWN0b3IoZ2FtZUJvYXJkSWQ6IHN0cmluZywgcHJpdmF0ZSBvbkZpZWxkQ2xpY2s6IChldjogRXZlbnQpID0+IHZvaWQsIHByaXZhdGUgZ2V0Q3VycmVudE1hcms6ICgpID0+IHN0cmluZykge1xyXG5cdFx0dGhpcy5ib2FyZEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGdhbWVCb2FyZElkKTtcclxuXHR9XHJcblxyXG5cdGluaXQgPSAoKTogdm9pZCA9PiB7XHJcblx0XHRjb25zdCBib2FyZEZpZWxkRWxlbWVudHM6IE5vZGVMaXN0T2Y8SFRNTEJ1dHRvbkVsZW1lbnQ+ID0gdGhpcy5ib2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmdhbWUtYm9hcmRfX2ZpZWxkJyk7XHJcblx0XHRmb3IgKGxldCByb3cgPSAwOyByb3cgPCB0aGlzLmJvYXJkLmxlbmd0aDsgcm93KyspIHtcclxuXHRcdFx0Zm9yIChsZXQgY29sdW1uID0gMDsgY29sdW1uIDwgdGhpcy5CT0FSRF9TSVpFOyBjb2x1bW4rKykge1xyXG5cdFx0XHRcdHRoaXMuYm9hcmRbcm93XS5wdXNoKFxyXG5cdFx0XHRcdFx0bmV3IEZpZWxkKFxyXG5cdFx0XHRcdFx0XHRyb3csXHJcblx0XHRcdFx0XHRcdGNvbHVtbixcclxuXHRcdFx0XHRcdFx0Ym9hcmRGaWVsZEVsZW1lbnRzW2NvbHVtbiArIHJvdyAqIHRoaXMuQk9BUkRfU0laRV0sXHJcblx0XHRcdFx0XHRcdHRoaXMub25GaWVsZENsaWNrLFxyXG5cdFx0XHRcdFx0XHR0aGlzLmdldEN1cnJlbnRNYXJrXHJcblx0XHRcdFx0XHQpXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdGNoZWNrRmllbGQgPSAobWFyazogc3RyaW5nLCByb3c6IG51bWJlciwgY29sdW1uOiBudW1iZXIpID0+IHtcclxuXHRcdGlmIChyb3cgPCB0aGlzLmJvYXJkLmxlbmd0aCAmJiBjb2x1bW4gPCB0aGlzLmJvYXJkWzBdLmxlbmd0aCkge1xyXG5cdFx0XHR0aGlzLmJvYXJkW3Jvd11bY29sdW1uXS5jaGVjayhtYXJrKTtcclxuXHRcdH1cclxuXHR9O1xyXG59XHJcbi8qIEdhbWVCb2FyZCBjbGFzcyBlbmQgKi9cclxuXHJcbi8qIEZpZWxkIGNsYXNzIHN0YXJ0ICovXHJcbmNsYXNzIEZpZWxkIHtcclxuXHRwcml2YXRlIG1hcms6IHN0cmluZyA9IG51bGw7XHJcblxyXG5cdGNvbnN0cnVjdG9yKFxyXG5cdFx0cHJpdmF0ZSByb3c6IG51bWJlcixcclxuXHRcdHByaXZhdGUgY29sdW1uOiBudW1iZXIsXHJcblx0XHRwcml2YXRlIGZpZWxkRWxlbWVudDogSFRNTEJ1dHRvbkVsZW1lbnQsXHJcblx0XHRwcml2YXRlIGdhbWVPbkNsaWNrSGFuZGxlcjogKGV2OiBFdmVudCkgPT4gdm9pZCxcclxuXHRcdHByaXZhdGUgZ2V0Q3VycmVudE1hcms6ICgpID0+IHN0cmluZ1xyXG5cdCkge1xyXG5cdFx0aWYgKHRoaXMuZmllbGRFbGVtZW50KSB7XHJcblx0XHRcdC8qIGNsaWNrIGhhbmRsaW5nICovXHJcblx0XHRcdHRoaXMuZmllbGRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5nYW1lT25DbGlja0hhbmRsZXIpO1xyXG5cdFx0XHQvKiBob3Zlci9mb2N1cyBpbiBoYW5kbGluZyAqL1xyXG5cdFx0XHR0aGlzLmZpZWxkRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCB0aGlzLmhhbmRsZUhvdmVyKTtcclxuXHRcdFx0dGhpcy5maWVsZEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIHRoaXMuaGFuZGxlSG92ZXIpO1xyXG5cdFx0XHQvKiBob3Zlci9mb2N1cyBvdXQgaGFuZGxpbmcgKi9cclxuXHRcdFx0dGhpcy5maWVsZEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdXQnLCB0aGlzLmhhbmRsZUJsdXIpO1xyXG5cdFx0XHR0aGlzLmZpZWxkRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIHRoaXMuaGFuZGxlQmx1cik7XHJcblx0XHRcdC8qIHNldHRpbmcgYXR0cmlidXRzICovXHJcblx0XHRcdHRoaXMuZmllbGRFbGVtZW50LmRhdGFzZXQucm93ID0gdGhpcy5yb3cudG9TdHJpbmcoKTtcclxuXHRcdFx0dGhpcy5maWVsZEVsZW1lbnQuZGF0YXNldC5jb2x1bW4gPSB0aGlzLmNvbHVtbi50b1N0cmluZygpO1xyXG5cdFx0XHR0aGlzLmZpZWxkRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgUm93ICR7dGhpcy5yb3cgKyAxfSwgY29sdW1uICR7dGhpcy5jb2x1bW4gKyAxfSwgZW1wdHkgZmllbGRgKTtcclxuXHJcblx0XHRcdHRoaXMuaW5zZXJ0SW1hZ2VzKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRoYW5kbGVIb3ZlciA9ICgpOiB2b2lkID0+IHtcclxuXHRcdGNvbnN0IGN1cnJlbnRQbGF5ZXJNYXJrID0gdGhpcy5nZXRDdXJyZW50TWFyaygpO1xyXG5cdFx0dGhpcy5maWVsZEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWN1cnJlbnQtcGxheWVyJywgY3VycmVudFBsYXllck1hcmspO1xyXG5cdH07XHJcblxyXG5cdGhhbmRsZUJsdXIgPSAoKSA9PiB7XHJcblx0XHR0aGlzLmZpZWxkRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtY3VycmVudC1wbGF5ZXInKTtcclxuXHR9O1xyXG5cclxuXHRpbnNlcnRJbWFnZXMgPSAoKSA9PiB7XHJcblx0XHRjb25zdCBvSW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuXHRcdG9JbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsICcuL2Rpc3QvYXNzZXRzL2ljb24tby5zdmcnKTtcclxuXHRcdG9JbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsICcnKTtcclxuXHRcdG9JbWFnZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtbmFtZScsICdvLWljb24nKTtcclxuXHRcdGNvbnN0IG9PdXRsaW5lSW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuXHRcdG9PdXRsaW5lSW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCAnLi9kaXN0L2Fzc2V0cy9pY29uLW8tb3V0bGluZS5zdmcnKTtcclxuXHRcdG9PdXRsaW5lSW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCAnJyk7XHJcblx0XHRvSW1hZ2Uuc2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnLCAnby1vdXRsaW5lLWljb24nKTtcclxuXHRcdGNvbnN0IHhJbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG5cdFx0eEltYWdlLnNldEF0dHJpYnV0ZSgnc3JjJywgJy4vZGlzdC9hc3NldHMvaWNvbi14LnN2ZycpO1xyXG5cdFx0eEltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgJycpO1xyXG5cdFx0eEltYWdlLnNldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJywgJ3gtaWNvbicpO1xyXG5cdFx0Y29uc3QgeE91dGxpbmVJbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG5cdFx0eE91dGxpbmVJbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsICcuL2Rpc3QvYXNzZXRzL2ljb24teC1vdXRsaW5lLnN2ZycpO1xyXG5cdFx0eE91dGxpbmVJbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsICcnKTtcclxuXHRcdHhPdXRsaW5lSW1hZ2Uuc2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnLCAneC1vdXRsaW5lLWljb24nKTtcclxuXHJcblx0XHR0aGlzLmZpZWxkRWxlbWVudC5hcHBlbmRDaGlsZChvSW1hZ2UpO1xyXG5cdFx0dGhpcy5maWVsZEVsZW1lbnQuYXBwZW5kQ2hpbGQoeEltYWdlKTtcclxuXHRcdHRoaXMuZmllbGRFbGVtZW50LmFwcGVuZENoaWxkKG9PdXRsaW5lSW1hZ2UpO1xyXG5cdFx0dGhpcy5maWVsZEVsZW1lbnQuYXBwZW5kQ2hpbGQoeE91dGxpbmVJbWFnZSk7XHJcblx0fTtcclxuXHJcblx0Y2hlY2sgPSAobWFyazogc3RyaW5nKTogdm9pZCA9PiB7XHJcblx0XHR0aGlzLm1hcmsgPSBtYXJrO1xyXG5cdFx0dGhpcy5maWVsZEVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgYFJvdyAke3RoaXMucm93ICsgMX0sIGNvbHVtbiAke3RoaXMuY29sdW1uICsgMX0sICR7dGhpcy5tYXJrfSBtYXJrYCk7XHJcblx0fTtcclxuXHJcblx0aXNDaGVja2VkID0gKCk6IGJvb2xlYW4gPT4ge1xyXG5cdFx0cmV0dXJuIHRoaXMubWFyayAhPT0gbnVsbDtcclxuXHR9O1xyXG5cclxuXHRnZXRNYXJrID0gKCk6IHN0cmluZyA9PiB7XHJcblx0XHRyZXR1cm4gdGhpcy5tYXJrO1xyXG5cdH07XHJcbn1cclxuLyogRmllbGQgY2xhc3MgZW5kICovXHJcblxyXG4vKiBQbGF5ZXIgY2xhc3Mgc3RhcnQgKi9cclxuY2xhc3MgUGxheWVyIHtcclxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIG5hbWU6IHN0cmluZywgcHJpdmF0ZSBtYXJrOiBzdHJpbmcsIHByaXZhdGUgc2NvcmU6IG51bWJlciA9IDApIHt9XHJcblxyXG5cdHRvU3RyaW5nID0gKCk6IHN0cmluZyA9PiBgJHt0aGlzLm1hcmt9ICgke3RoaXMubmFtZX0pYDtcclxuXHJcblx0Z2V0TWFyayA9ICgpOiBzdHJpbmcgPT4gdGhpcy5tYXJrO1xyXG5cclxuXHRnZXRTY29yZSA9ICgpOiBudW1iZXIgPT4gdGhpcy5zY29yZTtcclxuXHJcblx0dXBkYXRlU2NvcmUgPSAoKTogbnVtYmVyID0+ICsrdGhpcy5zY29yZTtcclxufVxyXG4vKiBQbGF5ZXIgY2xhc3MgZW5kICovXHJcbi8qIGNsYXNzZXMgZW5kICovXHJcblxyXG4vKiBnYW1lIG9iamVjdHMgKi9cclxuY29uc3QgdGljVGFjVG9lR2FtZTogR2FtZSA9IG5ldyBHYW1lKCcjZ2FtZS1tZW51JywgJyN0aWMtdGFjLXRvZS1nYW1lJyk7XHJcbi8qIGdhbWUgb2JqZWN0cyBlbmQgKi9cclxuIl19
